<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Scott Oatley - A Simulation Study Comparing Handling Missing Data Strategies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Scott Oatley</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../presentations/index.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../training/index.html"> 
<span class="menu-text">Training</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Scott0atley"> <i class="bi bi-GitHub" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Scott_Oatley_"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/scott-oatley-b87408157/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:mail.s2265605@ed.ac.uk"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Simulation Study Comparing Handling Missing Data Strategies</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Scott Oatley (s2265605@ed.ac.uk)</p>
<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>Missing data is a threat to the accurate reporting of substantive results within data analysis. While handling missing data strategies are widely available, many studies fail to account for missingness in their analysis. Those who do engage in handling missing data analysis sometimes engage in less than-gold-standard approaches that leave their substantive interpretation open toward methodological and statistical critique. These gold standard measures; multiple imputation (MI) and full information maximum likelihood (FIML), are rarely compared with one another. Mostly due to discipline-based preference, there has been little work on assessing if using one of these methods or the other would produce less biased estimates. This paper seeks to establish the real impact of implementing handling missing data methods upon statistical analysis and secondly, provide a direct comparison between multiple imputation and full information maximum likelihood methods of handling missing data. A simulation is performed on a variety of handling missing data strategies using a set seed for reproducibility. This simulation of methods is repeated 1000 times, and the 95% confidence intervals of the betas and standard errors of each model are presented to demonstrate the standard each handling missing data method provides the researcher. The results of this analysis confirm that under a missing at-random assumption, methods such as listwise deletion are not at all appropriate in handling missing data. Furthermore, naive methods are analysed, such as single-use imputation and found to be equally unattractive. Finally, results show that multiple imputations appear to provide the most accurate reporting of original ‘non-missing’ models compared to full information maximum likelihood techniques, though the difference is not large enough to rule it out as a viable ‘gold standard’. A discussion of statistical and time-based efficiency is also provided.</p>
<section id="key-words" class="level3">
<h3 class="anchored" data-anchor-id="key-words">Key Words</h3>
<p>MCAR, MAR, MNAR, Multiple Imputation, FIML</p>
</section>
</section>
<section id="justification-for-notebook" class="level2">
<h2 class="anchored" data-anchor-id="justification-for-notebook">Justification For Notebook</h2>
<p>Providing a literate workflow of any scientific investigations should be a baseline requiste of empirical research. Publishing a Jupyter Notebook allows individuals to not only reproduce the empirical work held within, it also provides a robust justification for each step in the research process. This process promotes open-science practices and encourages others to do the same.</p>
<p>Encouraging others to openly look at ones work invites critique. These critiques are welcome. The hope of using Notebooks is to have a much more organic and engaging research process whereby the research does not simply end once a paper is published. Critical comments can and will be incorporated into this Notebook to further research practices.</p>
<p>By providing a literate workflow where research, theory, justification, and ‘footnote’ analysis are all recorded in one place. This notebook invites a widespread auideance, ranging from other academics, to interested stakeholders. Whilst the language used in this Notebook is one intended for an academic auidence, the workflow presented should be possible for anyone that reads the Notebook and takes a methodical step-by-step approach to its application.</p>
<section id="using-stata" class="level3">
<h3 class="anchored" data-anchor-id="using-stata">Using Stata</h3>
<p>As Jupyter is a language agnostic program, the use of language used for analysis is left up to the individual researcher. For this Notebook, Stata is employed for all statistical analysis. Stata is a proprietary software and researchers MUST have access to Stata in order to undertake data analyses within the Jupyter notebook. A primary goal of extending this analysis is to undertake it in a different non-properiatory software.</p>
<p>Using Stata requires enabling the use of the ‘stata kernel’ in Jupyter. The instructions for which have been outlined in meticulous details in Connelly and Gayle (2019). For the sake of promoting a consistent introduction base for Jupyter Notebooks, and in an attempt to avoid needless confusing rhetoric at the beginning of such Notebooks, their original instructions are pasted below. I thank them for their work in pioneering best practices in the use of Notebooks for social scientific analysis:</p>
<section id="using-stata-via-magic-cells" class="level4">
<h4 class="anchored" data-anchor-id="using-stata-via-magic-cells">Using Stata via Magic Cells</h4>
<p>The approach for this Notebook uses Stata via magic cells. This facility can be downloaded and installed from <a href="https://github.com/TiesdeKok/ipystata">this github repository</a>.</p>
<p>At the command prompt you need to type:</p>
<p>pip install ipystata</p>
<p>In a code cell before using Stata you must type:</p>
<p>import ipystata</p>
<p>and then run the cell.</p>
<p>Each cell will now be a Stata code cell as long as you start your syntax with:</p>
<p>%%stata</p>
<p>For example to get a summary of the variables in Stata the cell should include the following code:</p>
<p>%%stata summarize</p>
<p>further information on using Stata via magic <a href="https://dev-ii-seminar.readthedocs.io/en/latest/notebooks/Stata_in_jupyter.html">is available here</a>.</p>
</section>
</section>
<section id="table-of-contents" class="level3">
<h3 class="anchored" data-anchor-id="table-of-contents">Table of Contents</h3>
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Background">Background</a></li>
<li><a href="#Missing">Missing Data Theory</a></li>
<li>Simulated Data</li>
<li>Preparation Programs</li>
<li>Descriptive Statistics</li>
<li>Missingness Models</li>
<li>Discussion of Results</li>
<li>Conclusions</li>
<li>Notes</li>
<li>Supplementary Materials</li>
<li>References</li>
</ul>
</section>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Missing Data pervades social scientific research. Without appropriately accounting for missing data in reserach agendas, this missingness can have stark consequences.</p>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>Missing data is a term that describes an instance whereby either an item (variable) or unit (person/entire observation) is missing from the sample. Missing data is common within social science research and even more ubiquitous within a longitudinal context where wave attrition and non-response are a rule rather than exception. The primary concern surrounding missing data is that dependent upon the type of missingness, there is potential to affect inferences made by the analysis of longitudinal studies (Hawkes and Plewis, 2006: 479; Silverwood et al., 2021). The various factors that account for sample attrition in the datasets presented thus far have the potential to present real issues as they relate to comprehensive data analysis.</p>
<p>Missingness attributed to death or emigration are considered ‘natural’ from the original sample. Those, however, that either refuse continued survey participation or complete surveys partially may present problems of biased estimates if the missingness is not appropriately discussed. Put simply, if there is an identified pattern within the missing data present within a given analysis this has the potential to influence results and alter substantive conclusions had this missingness not occurred – or been appropriately accounted for.</p>
<p>When a unit (case/observation) provides information on every possible item (variable) within a survey, this is a complete record. When information on certain items within a survey are missing, this is then called an incomplete record. When only part of all possible items is missing from the unit this is called item non-response. When all possible items are missing this is called unit non-response. Unit non-response is a natural consequence of a longitudinal survey design. The statistical techniques discussed henceforth will focus on item non-response because it is far more common in practice than the alternative.</p>
</section>
<section id="missing-data-theory" class="level1">
<h1>Missing Data Theory</h1>
<p>The investigation of missingness within data, through the creation of tables and graphical summaries of the full data compared to partially observed variables can beginning to identify the mechanisms underlying the patterns of missingness. The terminology that defines these mechanisms is unfortunately rather obtuse and confusing. The follow paragraphs attempt to best explain and define the key missingness mechanisms that are used with the methodological literature surrounding missing data whilst attempting to provide a clear and concise understanding.</p>
<p>The first major missingness mechanism is called Missing Completely At Random (MCAR). Suppose that only one variable Y has missing data, and that another set of variables represented by the vector X, is always observed (Marsden and Wright, 2010). The data is MCAR if the probability that Y is missing does not depend on either X or Y itself. Evaluating the assumption that missingness on Y depends on some observed variable in X is straightforward. Allison (2012) uses the example of income depending on gender by testing whether the proportions of men and women who report their income differ – a logistic regression in which the dependent variable is the response indicator could be estimated, and significant coefficients would suggest a violation of the MCAR mechanism (ibid). Testing whether missingness on Y does not depend on Y itself is much more complicated. Unless we have existing linked data such as tax records in the income example, it is almost impossible to evaluate this assumption. The upside of an MCAR mechanism is that estimated coefficients will not provide biased results in the presence of data Missing Completely At Random, however their estimation may be less precise (Kang, 2013).</p>
<p>The second missingness mechanism is missing at random (MAR). Data on Y is considered MAR if the probability that Y is missing does not depend on Y, once we control for X. MAR allows for missingness on Y to depend on other variables so long as it does not depend on Y itself.</p>
<p>Finally, missing not at random (MNAR) means missingness depends on unobserved values (Silverwood et al.&nbsp;2021), and that the probability that Y is missing depends on Y itself, after adjusting for X (Marsden and Wright, 2010). For example, people who have been arrested may be less likely to report their arrest status.</p>
<p>If data is found to be MAR or MCAR, then approaches like multiple imputation (MI), Full Information Maximum likelihood (FIML), and inverse probability weighting (IPW) are made available – the former being extensively documented with the NCDS (Hawkes and Plewis 2006). These ‘gold standard’ approaches to handling missing data have also been found to produce optimal estimates in the MNAR case but it is difficult to have confidence that any given MNAR model is correct (Marsden and Wright, 2010).</p>
</section>
<section id="methods-to-handle-missing-data" class="level1">
<h1>Methods to Handle Missing Data</h1>
<p>The following section explores each major attempt at handling missing data. These techniques and methods are bundled into ‘standards’ to express the level of appropriate application most of these approaches fall into. While the majority are placed in ‘less than gold standard’ approaches, that does not necessarily make them devoid of utility. There are three main categories that handling missing data techniques fall into: ‘gold standard’, ‘less than gold standard’, and ‘inadequate standard’. Each method for each category will be explained.</p>
<section id="inadequate-standard" class="level2">
<h2 class="anchored" data-anchor-id="inadequate-standard">Inadequate Standard</h2>
<p>The first inadequate standard given a MAR mechanism is present is listwise deletion. Listwise deletion removes all observations from the data with a missing value in one or more of the variables included in the analysis. This is also known as Complete Records Analysis (CRA). The CRA approach is unpredictable; there is no way to know the consequences of this loss of information if data is found to be MAR (Carpenter and Kenward, 2012). When data is found to be MAR, a CRA approach is inadequate at handling missing data.</p>
<p>Depending on the variable (either metric or categorical) a simple approach to handling missing data would be to use a single mean or single modal imputation. This, in the example of a categorical variable, takes the mode of the value in said variable and imputes that modal value across all missing values in the data. Single imputation ignores all uncertainty and always underestimates the variance in each model. Advocates of this approach argue that whilst not perfect this approach doesn’t delete a single case and incorporates all available information into a given model. However, this method does not have any confidence in its results. There is a possibility that the estimates from this method may fall close to the true range; of course, the exact opposite is equally likely. The use of single-use imputation has been consistently and conclusively shown to perform poorly except under exceptionally special conditions (Collins, Schafer and Kam, 2001; Little and Rubin, 2019). For these reasons, single use imputation is an inadequate method to handle missing data.</p>
</section>
<section id="less-than-gold-standard" class="level2">
<h2 class="anchored" data-anchor-id="less-than-gold-standard">Less than Gold Standard</h2>
<p>Dummy variable adjustment is another method of handling missing data that falls into the ‘less than gold standard’ category. Dummy variable adjustment may appear to be in the same category of handling missing data methods as single use imputation. This is, however, not the case. Dummy variable adjustment is where all missingness at the given variable is coded to a value within the model. In the example of a binary dummy variable, all missingness is coded to either equal zero or equal one. This does have the identical appeal to the single-use imputation of deleting no cases and incorporates all information into the regression model. However, there is a substantive difference between the two techniques. For the simple model of data missing at Y variable, a dummy variable adjustment will not provide the ‘true’ estimates but if the complete records analysis is compared to a model where all missingness equals zero and another model where all missingness equals one, then the range of the estimates can be located. Whilst Jones (1996) demonstrated that dummy variable adjustment yields biased parameter estimates even when the data is MCAR, the ability to provide a range of the estimates does provide some utility to this technique. Given a MAR example where the reported estimates are a reduced form from their ‘true’ values, iff the complete case analysis and both dummy variable adjustment models present a beta coefficient that is throughout all models positive, one can present those results similar to how we ought to interpret log odds. The results would present evidence for a positive coefficient – though the exact size is unknown, some information can be gathered. For this reason, dummy variable adjustment provides some utility in certain missing data scenarios. This technique has the most utility in scenarios where missingness is so great that it begins to stretch the abilities of even gold-standard techniques. This method for handling missing data is not perfect, but it does provide utility and allows the use of data that has large amounts of missingness.</p>
<p>Another method that deals with missing data is the use of survey weights. Survey weights consider missingness. Inverse Probability Weighting (IPW) creates weighted copies of complete records to remove selection bias introduced by missing data. Whilst IPW is a method of dealing with missing data, alternatives such as multiple imputation are regarded as much more efficient as IPW only determines weights from incomplete cases and partially observed cases are discarded in the weighted analysis. Due to this, weighted estimates can have unacceptably high variance (Seaman et al., 2012; Seaman and White, 2013; Little, Carpenter and Lee, 2022).As such IPWs are placed in the ‘less than gold standard’ category of handling missing data approaches.</p>
</section>
<section id="gold-standard" class="level2">
<h2 class="anchored" data-anchor-id="gold-standard">Gold Standard</h2>
<p>There are two ‘gold standard’ approaches to handling missing data, Multiple Imputation (MI) and Maximum Likelihood (ML). Referring to the latter method first, there are currently three ML estimation algorithms for use when missing data is present with either an MCAR or MAR mechanism. The first is the multiple-group method, whereby a sample is divided into subgroups which each share the same pattern of missing data. A likelihood function is computed for each of the subgroups and the groupwise likelihood functions are accumulated across the entire sample and maximised. There are some practical issues of implementing this multiple-group based ML approach (Enders, 2001). The major drawback of this approach however is that it is a group level, rather than individual level ML estimation. Another ML estimation is the expectation-maximisation (EM). This estimation uses a two-step iterative procedure where missing observations are filled in or imputed and the unknown parameters are estimated using maximum likelihood missing data algorithms. The EM approach can only be used to obtain ML estimates of a mean vector and covariance matrix and as a result standard errors will be negatively biased and bootstrapping is recommended (Enders, 2001). The final ML approach discussed here is the Full Information Maximum Likelihood (FIML) estimation. It has also been called the raw maximum likelihood estimation for its likelihood function being calculated at the individual. It is also exceptionally easy to implement compared to the other estimation procedures discussed (Enders, 2001). For these reasons, going forward ML discussions of handling missing data specifically refer to the FIML approach rather than the multiple-group or EM approach.</p>
<p>Multiple Imputation is the second of the ‘Gold standard’ handling missing data methods. Multiple imputation generates replacement values or imputations for the missing data values and repeats this procedure over many iterations to produce a ‘semi-Bayesian’ framework for the most appropriate fit of estimates. For multiple imputation models to be compared to a complete records analysis, the former needs to be ‘‘congenial’’ (White, Royston and Wood, 2011) with the latter. Congeniality or consistency in this respect means that the same variables in the complete record analysis are identical to those included in multiple imputation. Suppose the variables between complete records analysis and multiple imputation models differ. In that case, the correct variance/covariance matrix will not be estimated, and a substantive comparison between the two will become impossible and impracticable due to a loss of statistical power (Von Hippel, 2009; Lynch and Von Hippel, 2013).</p>
<p>Multivariate imputation by chained equations (MICE) is a form of multiple imputation that fills in or imputes missing data within a given dataset through iterative predictive models or k imputations. This specification is required when imputing a variable that must only take on specific values, such as the categorical nature of the economic activity response variable within the current analytical model. Using MICE, each imputation k is drawn from the posterior distribution of the parameters in the given imputation model, and then the model itself is imputed (Carpenter and Kenward, 2012). To create the kth imputation, new parameters are drawn from the posterior distribution. Multiple Imputation following MICE draws from Bayesian influences on the distribution of missing data upon observed data. An essential advantage of Multiple Imputation is that it can be applied for data missing at the response variable or its covariates (Carpenter and Kenward, 2012).</p>
<p>Multiple imputation uses auxiliary variables – variables not included in the main model but are used when setting the data to be imputed. The auxiliary variables’ main function is to improve the predictive ability of the imputation model over and above the information recovered from just using the information provided by the analytical variables in the model (Collins, Schafer and Kam, 2001). Auxiliary variables are essential when there are high levels of missingness upon a given variable (Johnson and Young, 2011; Young and Johnson, 2011). There is no strict threshold for what an auxiliary variable needs to be included within the imputation; however, some have recommended an r &gt; 0.4 on at least one of the analytical variables within the model (Allison, 2012a). However, this is disputed (Enders, 2010). Others, such as Silverwood et al.&nbsp;(2021), argue that if an auxiliary variable is predictive of the outcome variable, it makes them suitable for inclusion within the imputation model. An auxiliary variable does not have the requirement that the given variable has to have complete information to be valuable – auxiliary variables can still be influential when they have missingness (Enders, 2010).</p>
<p>Multiple Imputation can be implemented easily and readily across software platforms, unlike FIML. Multiple imputation does, however, have some drawbacks. It can be a lengthy procedure that has the potential to induce human error due to the need to select auxiliary variables, set the correct data for imputation, and set the correct seed etc. There is also a time efficiency argument, whereby for multiple imputation, if the dataset is large, or there are large amounts of missingness, then the time to impute the model of interest can take a large amount of time. MI is an attractive method because it is practical and widely applicable (Carpenter and Kenward, 2012).</p>
<p>Whilst original literature on missing data and MI typically referred to large datasets with marginal levels of missingness, contemporary studies and simulations have increasingly stretched and stress-tested the limits of MI (Hardt et al., 2013). A simulation by Hardt et al (2013) demonstrated that large amounts of missingness can be present within a model without breaking down MI or FIML mechanisms (ibid). Whilst their simulation stops at n=200 where 40 per cent missingness is acceptable, there general argument is that the greater the n the larger the missingness can be within a model without breaking MI or FIML so long as the models themselves are appropriately specified. Imputation-based models are consistently found to outperform a CRA in both absolute bias and Root Mean Squared Error (RMSE) with increasing levels of missingness (Hyuk Lee and Huber Jr., 2021). The most extreme case from Madely-Down et al (2019) demonstrates that so long as the imputation model is properly specified and data are MAR then unbiased results can be obtained even with up to 90 per cent missingness. An imputation model compared to a CRA can achieve a reduction in 99.97 per cent bias when missingness is at 90 per cent (ibid).</p>
</section>
</section>
<section id="comparisons-of-gold-standard-methods" class="level1">
<h1>Comparisons of Gold Standard Methods</h1>
<p>Paul Allison, in a series of articles (Allison, 2012a, 2012b, 2015), argues that FIML is 1) more straightforward to implement, 2) FIML has no incompatibility between an imputation model and an analysis model, 3) FIML produces a deterministic result rather than a different result every time, and 4) FIML is asymptomatically efficient.</p>
<p>Firstly, MI does have greater variability than FIML, but that increased choice in model selection is not necessarily a negative so long as proper procedures are followed. In fact, greater variability of choice has the potential to make MI a more attractive candidate for dealing with missingness over FIML. Secondly, MI models only run into an incompatibility problem when the MI model is inconsistent with the CRA model – something that, with appropriate testing and open science practices detailing the model construction, should not happen. Thirdly, MI models are deterministic, provided the same seed is used each time you run the imputation. The only time this would not be plausible would be when open science practices were not followed, and fellow researchers could not access the MI seed. Finally, the argument that FIML is asymptotically efficient only holds to a certain extent. MI models reach asymptotic efficiency by running an infinite number of imputations – though you can reach near full efficiency with a relatively small number of imputations, Allison (2015) argues, around 10. Overall, whilst FIML does offer some advantages, there is nothing so considerable theoretically as to desire FIML over MI on the condition that they both perform at near identical rates. So long as open science procedures are upheld, most major critiques of MI are dealt with.</p>
<p>There are very few comparisons between FIML and MI approaches to missing data, making it hard to assess whether one method is more efficient at dealing with missing data than the other. Before conducting any missing data methods on the NCDS data, a simulation is performed to assess the strengths of a range of handling missing data approaches, with the intent to directly compare FIML and MI methods.</p>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<p>Both FIML and MI practices require data to either be MCAR or MAR. A FIML approach can be achieved in Stata by using the ‘sem’ command – using structural equation modelling and using the ‘mlvm’ estimation option (mlvm means FIML). MI can also be achieved in Stata using the ‘mi’ commands using a semi-Bayesian approach that includes auxiliary variables. There are also other handling missing data methods available such as: single mean imputation and coding all data=0 OR =1. These practices are typically considered ‘bad’ ways of handling missing data but are included in the simulation as a comparison to FIML and MI methods.</p>
<p>The full simulation takes the form of 1000 iterations of a random normal distribution of 1000 observations around a normally distributed metric dependent variable and three independent dummy variables that share an identical distribution. Each independent variable has the same level of correlation associated with the dependent variable. This is to allow for a point of comparison when MAR missingness is injected into one variable and not the others to see what happens when handling missing data practices are implemented. Each model is isolated in its own program whereby a simulation is called using the programs function with an identical seed set to all models. The 95 per cent confidence intervals of the mean betas and standard errors for all variables within each model are gathered and reported.</p>
<p>This dependent variable and three independent variables form a basic OLS linear regression model that is called the ‘Complete Records God Model’. Named as such because no model in a normal social scientific framework would have all observations not missing and have prior knowledge of what the ‘complete’ model would have looked like if their model did have some element of missingness. In addition to this ‘God’ model the same regression is computed using the structural equation modelling framework in Stata to confirm the results would be identical. The next model is where missingness is introduced. Missingness is injected into independent variable three. This missingness accounts for 49 per cent missingness in the model. This amount of missingness is right on the cusp of what contemporary literature on multiple imputation and FIML allow. Dummy variable adjustment is produced whereby all missingness is coded as =0 and another is produced =1. Next a single use modal imputation is used – the same framework as a single use mean imputation but because the variable is categorical mode is used over mean. Finally, an FIML model under the SEM framework is produced alongside three different forms of Multiple Imputation models. The first is an MI with 10 imputations and no auxiliary variables, the second is an MI with 10 imputations and auxiliary variables, and finally the last model is an MI with 100 imputations and auxiliary variables.</p>
</section>
<section id="preparation-programs" class="level1">
<h1>Preparation Programs</h1>
<div id="a7129909" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:16.141863Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:16.138860Z&quot;}" data-execution_count="35">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> stata_setup</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>stata_setup.config(<span class="st">"C:\Program Files\Stata18"</span>, <span class="st">"se"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Prior to any simulation/analysis, some basic set up is required to save datasets and path folders.</p>
<div id="9146338e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:22.414949Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:22.375114Z&quot;}" data-execution_count="36">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> workingdata<span class="st">"G:\Stata data and do\do files\missing data\workingdata"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>cd <span class="st">"$workingdata"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. global workingdata"G:\Stata data and do\do files\missing data\workingdata"

. 
. cd "$workingdata"
G:\Stata data and do\do files\missing data\workingdata

. </code></pre>
</div>
</div>
<p>The first program, called “regressbase” simulates a dataset with 1000 observations. Four variables are generated to simulate a standard Ordinary Least Squares linear regression model with one y dependent variable and three x* independent variables. All variables, for ease of interpretation are generated as metric continuous variables. All variables are drawn from a normal distribution and their means and standard deviations are set at different amounts. This is to simulate the variety of independent variables that are typically used in a regression model. The dependent variable y is generated through a relationship to the independent variables to guarantee a significant relationship. The generation of y also sees the addition of an error term that is normally distributed.</p>
<p>This simulated dataset forms the base of all subsequent programs.</p>
<p>For the “regressbase” program, following the generation of variables, an OLS regression is performed and the betas and standard errors of each independent variable is stored as a newly generated variable.</p>
<div id="178d72cb" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:23.937992Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:23.898962Z&quot;}" data-execution_count="37">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>capture program drop regress1</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>program regress1, rclass</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>drop _all</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>regress y x1 x2 x3</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop regress1

. 
. program regress1, rclass
  1. drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. regress y x1 x2 x3
  8. 
. gen beta1 = _b[x1]
  9. gen se1 = _se[x1]
 10. gen lower1 = beta1 - 1.96 * se1
 11. gen upper1 = beta1 + 1.96 * se1
 12. 
. gen beta2 = _b[x2]
 13. gen se2 = _se[x2]
 14. gen lower2 = beta2 - 1.96 * se2
 15. gen upper2 = beta2 + 1.96 * se2
 16. 
. gen beta3 = _b[x3]
 17. gen se3 = _se[x3]
 18. gen lower3 = beta3 - 1.96 * se3
 19. gen upper3 = beta3 + 1.96 * se3
 20. 
. 
. end

. </code></pre>
</div>
</div>
<p>The second program, “sem1” is nearly identical to the first program. The difference lies in the regression model. Whereas the “regressbase” program uses OLS linear regression, the “sem1” program uses structural equation modeling with maximum likelihood with missing values estimation. These ‘base’ models should provide identical statistics but both are provided to assess and potential disparities between the two models.</p>
<div id="aa418980" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:25.002126Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:24.961369Z&quot;}" data-execution_count="38">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>capture program drop sem1</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>program sem1, rclass</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a> drop _all</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>sem (y <span class="op">&lt;-</span> x1 x2 x3), method(mlmv)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. 
. capture program drop sem1

. 
. program sem1, rclass
  1.  drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. sem (y &lt;- x1 x2 x3), method(mlmv)
  8. 
. gen beta1 = _b[x1]
  9. gen se1 = _se[x1]
 10. gen lower1 = beta1 - 1.96 * se1
 11. gen upper1 = beta1 + 1.96 * se1
 12. 
. gen beta2 = _b[x2]
 13. gen se2 = _se[x2]
 14. gen lower2 = beta2 - 1.96 * se2
 15. gen upper2 = beta2 + 1.96 * se2
 16. 
. gen beta3 = _b[x3]
 17. gen se3 = _se[x3]
 18. gen lower3 = beta3 - 1.96 * se3
 19. gen upper3 = beta3 + 1.96 * se3
 20. 
. end

. </code></pre>
</div>
</div>
<p>The third program, “missingmcar” generates a Missing Completely At Random (MCAR) mechanism and injects this into the OLS linear regression model. The MCAR mechanism is generated by first generating a new mcar varibale that is based on a binomial distribution where 50 per cent of values are coded as 1 and 50 per cent are coded as 0. This is then used to replace values in x2 equal to missing if values in mcar equal zero. This simulates a MCAR mechanism of missing completely at random. Under this mechanism, missingness even as much as 50 per cent should not alter the interpretation of the model.</p>
<div id="211485dc" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:25.877478Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:25.837466Z&quot;}" data-execution_count="39">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>capture program drop missingmcar</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>program missingmcar, rclass</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a> drop _all</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate MCAR </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>gen rmcar <span class="op">=</span> rbinomial(<span class="dv">1</span>, <span class="fl">0.5</span>)  <span class="op">//</span> MCAR: <span class="dv">50</span><span class="op">%</span> chance of missingness (binary random)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> . <span class="cf">if</span> rmcar <span class="op">==</span> <span class="dv">0</span>  <span class="op">//</span> Set x to missing where rmcar <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>regress y x1 x2 x3</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop missingmcar

. 
. program missingmcar, rclass
  1.  drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. * Generate MCAR 
. gen rmcar = rbinomial(1, 0.5)  // MCAR: 50% chance of missingness (binary ran
&gt; dom)
  8. replace x2 = . if rmcar == 0  // Set x to missing where rmcar == 0
  9. 
. regress y x1 x2 x3
 10. 
. gen beta1 = _b[x1]
 11. gen se1 = _se[x1]
 12. gen lower1 = beta1 - 1.96 * se1
 13. gen upper1 = beta1 + 1.96 * se1
 14. 
. gen beta2 = _b[x2]
 15. gen se2 = _se[x2]
 16. gen lower2 = beta2 - 1.96 * se2
 17. gen upper2 = beta2 + 1.96 * se2
 18. 
. gen beta3 = _b[x3]
 19. gen se3 = _se[x3]
 20. gen lower3 = beta3 - 1.96 * se3
 21. gen upper3 = beta3 + 1.96 * se3
 22. 
. 
. end

. </code></pre>
</div>
</div>
<p>The fourth program, “missingmar” follows a similar pattern to the “missingmcar” program but instead of injecting a mcar mechanism, it injects a Missing At Random (MAR) mechanism. The MAR mechanism is generated by first generating a new probability of MAR variable based on the logistic curve of y-2105.2. (The -2105.2 is used to center y in order to ascertain a 50 per cent missingness mechanism). The values of x2 are made equal to missing if the probability of MAR variable is equal to zero.</p>
<div id="9487b381" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:26.679756Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:26.640743Z&quot;}" data-execution_count="40">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>capture program drop missingmar</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>program missingmar, rclass</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a> drop _all</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate MAR</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>gen prob_mar <span class="op">=</span> logistic(y<span class="op">-</span><span class="dv">21791</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>gen rmar <span class="op">=</span> <span class="dv">0</span> <span class="cf">if</span> prob_mar<span class="op">==</span><span class="dv">0</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> . <span class="cf">if</span> rmar <span class="op">==</span> <span class="dv">0</span>  <span class="op">//</span> Set x to missing where rmar <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>regress y x1 x2 x3</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop missingmar

. 
. program missingmar, rclass
  1.  drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. * Generate MAR
. gen prob_mar = logistic(y-21791)
  8. gen rmar = 0 if prob_mar==0
  9. replace x2 = . if rmar == 0  // Set x to missing where rmar == 0
 10. regress y x1 x2 x3
 11. 
. gen beta1 = _b[x1]
 12. gen se1 = _se[x1]
 13. gen lower1 = beta1 - 1.96 * se1
 14. gen upper1 = beta1 + 1.96 * se1
 15. 
. gen beta2 = _b[x2]
 16. gen se2 = _se[x2]
 17. gen lower2 = beta2 - 1.96 * se2
 18. gen upper2 = beta2 + 1.96 * se2
 19. 
. gen beta3 = _b[x3]
 20. gen se3 = _se[x3]
 21. gen lower3 = beta3 - 1.96 * se3
 22. gen upper3 = beta3 + 1.96 * se3
 23. 
. 
. end

. </code></pre>
</div>
</div>
<p>The program “missingmean” is the first handling missing data method implemented. This program performs single mean imputation across the 50 per cent missingness within the model. The mean of x2 is generated and used to replace all missing values in x2.</p>
<div id="22997fca" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:27.504639Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:27.465934Z&quot;}" data-execution_count="41">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>capture program drop missingmean</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>program missingmean, rclass</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a> drop _all</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate MAR</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>gen prob_mar <span class="op">=</span> logistic(y<span class="op">-</span><span class="dv">21791</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>gen rmar <span class="op">=</span> <span class="dv">0</span> <span class="cf">if</span> prob_mar<span class="op">==</span><span class="dv">0</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> . <span class="cf">if</span> rmar <span class="op">==</span> <span class="dv">0</span>  <span class="op">//</span> Set x to missing where rmar <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>summarize x2, meanonly</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> r(mean) <span class="cf">if</span> missing(x2)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>regress y x1 x2 x3</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop missingmean

. 
. program missingmean, rclass
  1.  drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. * Generate MAR
. gen prob_mar = logistic(y-21791)
  8. gen rmar = 0 if prob_mar==0
  9. replace x2 = . if rmar == 0  // Set x to missing where rmar == 0
 10. 
. summarize x2, meanonly
 11. replace x2 = r(mean) if missing(x2)
 12. 
. regress y x1 x2 x3
 13. 
. gen beta1 = _b[x1]
 14. gen se1 = _se[x1]
 15. gen lower1 = beta1 - 1.96 * se1
 16. gen upper1 = beta1 + 1.96 * se1
 17. 
. gen beta2 = _b[x2]
 18. gen se2 = _se[x2]
 19. gen lower2 = beta2 - 1.96 * se2
 20. gen upper2 = beta2 + 1.96 * se2
 21. 
. gen beta3 = _b[x3]
 22. gen se3 = _se[x3]
 23. gen lower3 = beta3 - 1.96 * se3
 24. gen upper3 = beta3 + 1.96 * se3
 25. 
. 
. end

. </code></pre>
</div>
</div>
<p>The program “semmlvm” is the ‘gold standard’ Full Information Maximum Likelihood attempt to recover unbiased estimates following an injection of a MAR mechanism. FIML is performed using the sem command with the mlvm estimation.</p>
<div id="ab0e26f2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:28.439957Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:28.401159Z&quot;}" data-execution_count="42">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>capture program drop semmlmv</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>program semmlmv, rclass</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> drop <span class="bu">all</span> variables to create an empty dataset</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    drop _all</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate MAR</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>gen prob_mar <span class="op">=</span> logistic(y<span class="op">-</span><span class="dv">21791</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>gen rmar <span class="op">=</span> <span class="dv">0</span> <span class="cf">if</span> prob_mar<span class="op">==</span><span class="dv">0</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> . <span class="cf">if</span> rmar <span class="op">==</span> <span class="dv">0</span>  <span class="op">//</span> Set x to missing where rmar <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Model estimation</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>sem (y <span class="op">&lt;-</span> x1 x2 x3), method(mlmv)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop semmlmv

. 
. program semmlmv, rclass
  1.     * drop all variables to create an empty dataset
.     drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. * Generate MAR
. gen prob_mar = logistic(y-21791)
  8. gen rmar = 0 if prob_mar==0
  9. replace x2 = . if rmar == 0  // Set x to missing where rmar == 0
 10.     
. * Model estimation
. sem (y &lt;- x1 x2 x3), method(mlmv)
 11. 
. gen beta1 = _b[x1]
 12. gen se1 = _se[x1]
 13. gen lower1 = beta1 - 1.96 * se1
 14. gen upper1 = beta1 + 1.96 * se1
 15. 
. gen beta2 = _b[x2]
 16. gen se2 = _se[x2]
 17. gen lower2 = beta2 - 1.96 * se2
 18. gen upper2 = beta2 + 1.96 * se2
 19. 
. gen beta3 = _b[x3]
 20. gen se3 = _se[x3]
 21. gen lower3 = beta3 - 1.96 * se3
 22. gen upper3 = beta3 + 1.96 * se3
 23.     
. 
. end

. </code></pre>
</div>
</div>
<p>The program “minoaux1” performs multiple imputation with 10 iterations and 10 burnins with zero auxiliary variables.</p>
<div id="53a639bc" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:29.407990Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:29.369542Z&quot;}" data-execution_count="43">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>capture program drop minoaux1</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>program minoaux1, rclass</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> drop <span class="bu">all</span> variables to create an empty dataset</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    drop _all</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate MAR</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>gen prob_mar <span class="op">=</span> logistic(y<span class="op">-</span><span class="dv">21791</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>gen rmar <span class="op">=</span> <span class="dv">0</span> <span class="cf">if</span> prob_mar<span class="op">==</span><span class="dv">0</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> . <span class="cf">if</span> rmar <span class="op">==</span> <span class="dv">0</span>  <span class="op">//</span> Set x to missing where rmar <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> Model estimation</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>mi <span class="bu">set</span> wide</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>mi register imputed y x1 x2 x3</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>tab _mi_miss</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>mi impute chained <span class="op">///</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="op">///</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>(regress) y x1 x2 x3 <span class="op">///</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>, rseed(<span class="dv">12345</span>) dots force add(<span class="dv">10</span>) burnin(<span class="dv">10</span>) </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>mi estimate, post dots: regress y x1 x2 x3</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop minoaux1

. 
. program minoaux1, rclass
  1.     * drop all variables to create an empty dataset
.     drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. * Generate MAR
. gen prob_mar = logistic(y-21791)
  8. gen rmar = 0 if prob_mar==0
  9. replace x2 = . if rmar == 0  // Set x to missing where rmar == 0
 10.         
.     * Model estimation
. 
. mi set wide
 11. 
. mi register imputed y x1 x2 x3
 12. 
. tab _mi_miss
 13. 
. 
. mi impute chained ///
&gt; ///
&gt; (regress) y x1 x2 x3 ///
&gt; , rseed(12345) dots force add(10) burnin(10) 
 14. 
. 
. mi estimate, post dots: regress y x1 x2 x3
 15. 
. gen beta1 = _b[x1]
 16. gen se1 = _se[x1]
 17. gen lower1 = beta1 - 1.96 * se1
 18. gen upper1 = beta1 + 1.96 * se1
 19. 
. gen beta2 = _b[x2]
 20. gen se2 = _se[x2]
 21. gen lower2 = beta2 - 1.96 * se2
 22. gen upper2 = beta2 + 1.96 * se2
 23. 
. gen beta3 = _b[x3]
 24. gen se3 = _se[x3]
 25. gen lower3 = beta3 - 1.96 * se3
 26. gen upper3 = beta3 + 1.96 * se3
 27.     
. 
. end

. </code></pre>
</div>
</div>
<p>The program “miaux1” performs multiple imputation with 10 iterations and 10 burnins with eight auxiliary variables. Five auxiliary variables are generated that are predictive of the probability of the missingness and the missing values, three are generated that are predictive of only the missing values themselves.</p>
<div id="9ea60bbb" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:30.549127Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:30.509406Z&quot;}" data-execution_count="44">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>capture program drop miaux1</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>program miaux1, rclass</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> drop <span class="bu">all</span> variables to create an empty dataset</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    drop _all</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate MAR</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>gen prob_mar <span class="op">=</span> logistic(y<span class="op">-</span><span class="dv">21791</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>gen rmar <span class="op">=</span> <span class="dv">0</span> <span class="cf">if</span> prob_mar<span class="op">==</span><span class="dv">0</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> . <span class="cf">if</span> rmar <span class="op">==</span> <span class="dv">0</span>  <span class="op">//</span> Set x to missing where rmar <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate Auxiliary Variables Predictive of Probability of Missingness <span class="kw">and</span> Missing Values  </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>gen aux1 <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">10</span>)   <span class="op">//</span> Correlated <span class="cf">with</span> x2 <span class="kw">and</span> y</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>gen aux2 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">15</span>)   <span class="op">//</span> Balanced correlation <span class="cf">with</span> x2 <span class="kw">and</span> y</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>gen aux3 <span class="op">=</span> <span class="fl">0.6</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span>x1 <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">12</span>)   <span class="op">//</span> Adds x1 <span class="cf">for</span> slight variation</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>gen aux4 <span class="op">=</span> <span class="fl">0.4</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.6</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">20</span>)   <span class="op">//</span> Heavier weight on y (missingness predictor)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>gen aux5 <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span>y <span class="op">+</span> <span class="fl">0.4</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">18</span>)  <span class="op">//</span> Introduces correlation <span class="cf">with</span> x3</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate Auxiliary Variables Predictive of ONLY Missing Values </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>gen aux6 <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span>x2 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">10</span>)   <span class="op">//</span> Strong correlation <span class="cf">with</span> x2, no y dependence</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>gen aux7 <span class="op">=</span> <span class="fl">0.8</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">12</span>)   <span class="op">//</span> Includes x3, but no direct link to missingness</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>gen aux8 <span class="op">=</span> <span class="fl">0.85</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.1</span><span class="op">*</span>x1 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">15</span>)  <span class="op">//</span> Includes x1, but missingness<span class="op">-</span>independent</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> setting MI data up</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>mi <span class="bu">set</span> wide</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>mi register imputed y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 </span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>mi impute chained <span class="op">///</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="op">///</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>(regress) y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 <span class="op">///</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>, rseed(<span class="dv">12345</span>) dots force add(<span class="dv">10</span>) burnin(<span class="dv">10</span>) </span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> mi model</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>mi estimate, post dots: regress y x1 x2 x3</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop miaux1

. 
. 
. program miaux1, rclass
  1.     * drop all variables to create an empty dataset
.     drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. * Generate MAR
. gen prob_mar = logistic(y-21791)
  8. gen rmar = 0 if prob_mar==0
  9. replace x2 = . if rmar == 0  // Set x to missing where rmar == 0
 10.         
.         
. * Generate Auxiliary Variables Predictive of Probability of Missingness and M
&gt; issing Values      
. gen aux1 = 0.7*x2 + 0.3*y + rnormal(0, 10)   // Correlated with x2 and y
 11. gen aux2 = 0.5*x2 + 0.5*y + rnormal(0, 15)   // Balanced correlation with 
&gt; x2 and y
 12. gen aux3 = 0.6*x2 + 0.2*x1 + 0.2*y + rnormal(0, 12)   // Adds x1 for sligh
&gt; t variation
 13. gen aux4 = 0.4*x2 + 0.6*y + rnormal(0, 20)   // Heavier weight on y (missi
&gt; ngness predictor)
 14. gen aux5 = 0.3*x2 + 0.3*y + 0.4*x3 + rnormal(0, 18)  // Introduces correla
&gt; tion with x3
 15. 
. * Generate Auxiliary Variables Predictive of ONLY Missing Values 
. 
. gen aux6 = 0.9*x2 + rnormal(0, 10)   // Strong correlation with x2, no y depe
&gt; ndence
 16. gen aux7 = 0.8*x2 + 0.2*x3 + rnormal(0, 12)   // Includes x3, but no direc
&gt; t link to missingness
 17. gen aux8 = 0.85*x2 + 0.1*x1 + rnormal(0, 15)  // Includes x1, but missingn
&gt; ess-independent
 18.         
. * setting MI data up
. 
. mi set wide
 19. 
. mi register imputed y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 
 20. 
. 
. mi impute chained ///
&gt; ///
&gt; (regress) y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 ///
&gt; , rseed(12345) dots force add(10) burnin(10) 
 21. 
. 
. * mi model
. 
. mi estimate, post dots: regress y x1 x2 x3
 22. 
. gen beta1 = _b[x1]
 23. gen se1 = _se[x1]
 24. gen lower1 = beta1 - 1.96 * se1
 25. gen upper1 = beta1 + 1.96 * se1
 26. 
. gen beta2 = _b[x2]
 27. gen se2 = _se[x2]
 28. gen lower2 = beta2 - 1.96 * se2
 29. gen upper2 = beta2 + 1.96 * se2
 30. 
. gen beta3 = _b[x3]
 31. gen se3 = _se[x3]
 32. gen lower3 = beta3 - 1.96 * se3
 33. gen upper3 = beta3 + 1.96 * se3
 34.     
. 
. end

. </code></pre>
</div>
</div>
<p>The final program “miaux100” performs multiple imputation with 100 iterations and 20 burnin using the prior generated eight auxiliary variables.</p>
<div id="b1ef5ccb" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:31.537157Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:31.498974Z&quot;}" data-execution_count="45">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>capture program drop miaux100</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>program miaux100, rclass</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> drop <span class="bu">all</span> variables to create an empty dataset</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    drop _all</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Set number of observations</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> obs <span class="dv">1000</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#1</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>drawnorm x1, n(<span class="dv">1000</span>) means(<span class="dv">40</span>) sds(<span class="dv">12</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#2</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>drawnorm x2, n(<span class="dv">1000</span>) means(<span class="dv">200</span>) sds(<span class="dv">50</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric independent variable <span class="co">#3</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>drawnorm x3, n(<span class="dv">1000</span>) means(<span class="dv">150</span>) sds(<span class="dv">5</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate metric dependent variable</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>gen y <span class="op">=</span> <span class="dv">30</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">40</span><span class="op">*</span>x2 <span class="op">+</span> <span class="dv">50</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">5000</span>, <span class="dv">1500</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate MAR</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>gen prob_mar <span class="op">=</span> logistic(y<span class="op">-</span><span class="dv">21791</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>gen rmar <span class="op">=</span> <span class="dv">0</span> <span class="cf">if</span> prob_mar<span class="op">==</span><span class="dv">0</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>replace x2 <span class="op">=</span> . <span class="cf">if</span> rmar <span class="op">==</span> <span class="dv">0</span>  <span class="op">//</span> Set x to missing where rmar <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate Auxiliary Variables Predictive of Probability of Missingness <span class="kw">and</span> Missing Values  </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>gen aux1 <span class="op">=</span> <span class="fl">0.7</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">10</span>)   <span class="op">//</span> Correlated <span class="cf">with</span> x2 <span class="kw">and</span> y</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>gen aux2 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">15</span>)   <span class="op">//</span> Balanced correlation <span class="cf">with</span> x2 <span class="kw">and</span> y</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>gen aux3 <span class="op">=</span> <span class="fl">0.6</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span>x1 <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">12</span>)   <span class="op">//</span> Adds x1 <span class="cf">for</span> slight variation</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>gen aux4 <span class="op">=</span> <span class="fl">0.4</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.6</span><span class="op">*</span>y <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">20</span>)   <span class="op">//</span> Heavier weight on y (missingness predictor)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>gen aux5 <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span>y <span class="op">+</span> <span class="fl">0.4</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">18</span>)  <span class="op">//</span> Introduces correlation <span class="cf">with</span> x3</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Generate Auxiliary Variables Predictive of ONLY Missing Values </span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>gen aux6 <span class="op">=</span> <span class="fl">0.9</span><span class="op">*</span>x2 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">10</span>)   <span class="op">//</span> Strong correlation <span class="cf">with</span> x2, no y dependence</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>gen aux7 <span class="op">=</span> <span class="fl">0.8</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span>x3 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">12</span>)   <span class="op">//</span> Includes x3, but no direct link to missingness</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>gen aux8 <span class="op">=</span> <span class="fl">0.85</span><span class="op">*</span>x2 <span class="op">+</span> <span class="fl">0.1</span><span class="op">*</span>x1 <span class="op">+</span> rnormal(<span class="dv">0</span>, <span class="dv">15</span>)  <span class="op">//</span> Includes x1, but missingness<span class="op">-</span>independent</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> setting MI data up</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>mi <span class="bu">set</span> wide</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>mi register imputed y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 </span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>mi impute chained <span class="op">///</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a><span class="op">///</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>(regress) y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 <span class="op">///</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>, rseed(<span class="dv">12345</span>) dots force add(<span class="dv">100</span>) burnin(<span class="dv">20</span>) </span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> mi model</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>mi estimate, post dots: regress y x1 x2 x3</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>gen beta1 <span class="op">=</span> _b[x1]</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>gen se1 <span class="op">=</span> _se[x1]</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>gen lower1 <span class="op">=</span> beta1 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>gen upper1 <span class="op">=</span> beta1 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se1</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>gen beta2 <span class="op">=</span> _b[x2]</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>gen se2 <span class="op">=</span> _se[x2]</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>gen lower2 <span class="op">=</span> beta2 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>gen upper2 <span class="op">=</span> beta2 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se2</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>gen beta3 <span class="op">=</span> _b[x3]</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>gen se3 <span class="op">=</span> _se[x3]</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>gen lower3 <span class="op">=</span> beta3 <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> se3</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>gen upper3 <span class="op">=</span> beta3 <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> se3   </span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. capture program drop miaux100

. 
. 
. program miaux100, rclass
  1.     * drop all variables to create an empty dataset
.     drop _all
  2.     
. * Set number of observations
. set obs 1000
  3.     
. * Generate metric independent variable #1
. drawnorm x1, n(1000) means(40) sds(12)
  4. 
. * Generate metric independent variable #2
. drawnorm x2, n(1000) means(200) sds(50)
  5. 
. * Generate metric independent variable #3
. drawnorm x3, n(1000) means(150) sds(5)
  6. 
. * Generate metric dependent variable
. gen y = 30*x1 + 40*x2 + 50*x3 + rnormal(5000, 1500)
  7. 
. * Generate MAR
. gen prob_mar = logistic(y-21791)
  8. gen rmar = 0 if prob_mar==0
  9. replace x2 = . if rmar == 0  // Set x to missing where rmar == 0
 10.         
.         
. * Generate Auxiliary Variables Predictive of Probability of Missingness and M
&gt; issing Values      
. gen aux1 = 0.7*x2 + 0.3*y + rnormal(0, 10)   // Correlated with x2 and y
 11. gen aux2 = 0.5*x2 + 0.5*y + rnormal(0, 15)   // Balanced correlation with 
&gt; x2 and y
 12. gen aux3 = 0.6*x2 + 0.2*x1 + 0.2*y + rnormal(0, 12)   // Adds x1 for sligh
&gt; t variation
 13. gen aux4 = 0.4*x2 + 0.6*y + rnormal(0, 20)   // Heavier weight on y (missi
&gt; ngness predictor)
 14. gen aux5 = 0.3*x2 + 0.3*y + 0.4*x3 + rnormal(0, 18)  // Introduces correla
&gt; tion with x3
 15. 
. * Generate Auxiliary Variables Predictive of ONLY Missing Values 
. 
. gen aux6 = 0.9*x2 + rnormal(0, 10)   // Strong correlation with x2, no y depe
&gt; ndence
 16. gen aux7 = 0.8*x2 + 0.2*x3 + rnormal(0, 12)   // Includes x3, but no direc
&gt; t link to missingness
 17. gen aux8 = 0.85*x2 + 0.1*x1 + rnormal(0, 15)  // Includes x1, but missingn
&gt; ess-independent
 18.         
. * setting MI data up
. 
. mi set wide
 19. 
. mi register imputed y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 
 20. 
. 
. mi impute chained ///
&gt; ///
&gt; (regress) y x1 x2 x3 aux1 aux2 aux3 aux4 aux5 aux6 aux7 aux8 ///
&gt; , rseed(12345) dots force add(100) burnin(20) 
 21. 
. 
. * mi model
. 
. mi estimate, post dots: regress y x1 x2 x3
 22. 
. gen beta1 = _b[x1]
 23. gen se1 = _se[x1]
 24. gen lower1 = beta1 - 1.96 * se1
 25. gen upper1 = beta1 + 1.96 * se1
 26. 
. gen beta2 = _b[x2]
 27. gen se2 = _se[x2]
 28. gen lower2 = beta2 - 1.96 * se2
 29. gen upper2 = beta2 + 1.96 * se2
 30. 
. gen beta3 = _b[x3]
 31. gen se3 = _se[x3]
 32. gen lower3 = beta3 - 1.96 * se3
 33. gen upper3 = beta3 + 1.96 * se3   
 34. 
. end

. </code></pre>
</div>
</div>
<p>This next section of the Notebook now runs each program simulation. Each simulation is run 1000 times with a set seed of “1234” for each program simulation. The 95 per cent confidence intervals of the means for each beta and standard error within the models is extracted and the dataset is then saved for each simulation.</p>
<div id="1ffac7b4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:25:43.464071Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:25:33.769859Z&quot;}" data-execution_count="46">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): regress1 </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1a </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1a </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2a </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2a </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3a </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3a </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1a </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2a </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3a </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1a </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2a </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3a </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>save godmodel, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): regress1 

      Command: regress1
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    30.00808    .1223364        29.76802    30.24815
      _sim_2 |      1,000    3.958464    .0039263        3.950759    3.966169
      _sim_3 |      1,000    40.01876    .0299956         39.9599    40.07762
      _sim_4 |      1,000    .9516209    .0009688        .9497198    .9535221
      _sim_5 |      1,000    49.87959    .3001486        49.29059    50.46858
-------------+---------------------------------------------------------------
      _sim_6 |      1,000     9.51589    .0095674        9.497115    9.534664
      _sim_7 |      1,000    22.24949    .1221543        22.00978     22.4892
      _sim_8 |      1,000    38.15358    .0300231        38.09467     38.2125
      _sim_9 |      1,000    31.22844    .2998234        30.64009     31.8168
     _sim_10 |      1,000    37.76667    .1230006         37.5253    38.00804
-------------+---------------------------------------------------------------
     _sim_11 |      1,000    41.88393    .0300882        41.82489    41.94298
     _sim_12 |      1,000    68.53073    .3016415        67.93881    69.12265

. 
. rename _sim_1 beta1a 

. rename _sim_2 se1a 

. rename _sim_3 beta2a 

. rename _sim_4 se2a 

. rename _sim_5 beta3a 

. rename _sim_6 se3a 

. rename _sim_7 ll1a 

. rename _sim_8 ll2a 

. rename _sim_9 ll3a 

. rename _sim_10 ul1a 

. rename _sim_11 ul2a 

. rename _sim_12 ul3a 

. 
. 
. save godmodel, replace
file godmodel.dta saved

. </code></pre>
</div>
</div>
<div id="8e981272" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:26:27.798173Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:26:01.489356Z&quot;}" data-execution_count="47">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): sem1 </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1b</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1b</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2b </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2b</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3b </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3b</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1b </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2b </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3b </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1b </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2b </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3b </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>save semgodmodel, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): sem1 

      Command: sem1
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    30.00808    .1223364        29.76802    30.24815
      _sim_2 |      1,000    3.950539    .0039185         3.94285    3.958229
      _sim_3 |      1,000    40.01876    .0299956         39.9599    40.07762
      _sim_4 |      1,000    .9497158    .0009669        .9478184    .9516131
      _sim_5 |      1,000    49.87959    .3001486        49.29059    50.46858
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    9.496839    .0095483        9.478102    9.515576
      _sim_7 |      1,000    22.26502    .1221542        22.02532    22.50473
      _sim_8 |      1,000    38.15731    .0300229         38.0984    38.21623
      _sim_9 |      1,000    31.26578    .2998229        30.67743    31.85414
     _sim_10 |      1,000    37.75114    .1229988        37.50977     37.9925
-------------+---------------------------------------------------------------
     _sim_11 |      1,000     41.8802    .0300878        41.82116    41.93924
     _sim_12 |      1,000    68.49339    .3016373        67.90147    69.08531

. 
. rename _sim_1 beta1b

. rename _sim_2 se1b

. rename _sim_3 beta2b 

. rename _sim_4 se2b

. rename _sim_5 beta3b 

. rename _sim_6 se3b

. rename _sim_7 ll1b 

. rename _sim_8 ll2b 

. rename _sim_9 ll3b 

. rename _sim_10 ul1b 

. rename _sim_11 ul2b 

. rename _sim_12 ul3b 

. 
. save semgodmodel, replace
file semgodmodel.dta saved

. </code></pre>
</div>
</div>
<div id="ac4eea06" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:26:37.845652Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:26:27.800576Z&quot;}" data-execution_count="48">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): missingmcar </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1c</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1c</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2c </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2c</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3c </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3c</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1c </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2c </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3c </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1c </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2c </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3c </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>save missingmcar, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): missingmcar 

      Command: missingmcar
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

.     
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    29.96598    .1732293        29.62604    30.30591
      _sim_2 |      1,000    5.622786    .0085991        5.605912     5.63966
      _sim_3 |      1,000    40.02882    .0423628        39.94568    40.11195
      _sim_4 |      1,000    1.348911     .002079        1.344832    1.352991
      _sim_5 |      1,000    51.29684     .436001        50.44125    52.15242
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    13.47856    .0213482        13.43667    13.52046
      _sim_7 |      1,000    18.94532    .1742216        18.60344     19.2872
      _sim_8 |      1,000    37.38495     .042557        37.30144    37.46846
      _sim_9 |      1,000    24.87885    .4352299        24.02478    25.73292
     _sim_10 |      1,000    40.98664    .1738728        40.64544    41.32784
-------------+---------------------------------------------------------------
     _sim_11 |      1,000    42.67268    .0425597        42.58916     42.7562
     _sim_12 |      1,000    77.71482     .440761         76.8499    78.57974

. 
. rename _sim_1 beta1c

. rename _sim_2 se1c

. rename _sim_3 beta2c 

. rename _sim_4 se2c

. rename _sim_5 beta3c 

. rename _sim_6 se3c

. rename _sim_7 ll1c 

. rename _sim_8 ll2c 

. rename _sim_9 ll3c 

. rename _sim_10 ul1c 

. rename _sim_11 ul2c 

. rename _sim_12 ul3c 

. 
. save missingmcar, replace
file missingmcar.dta saved

. </code></pre>
</div>
</div>
<div id="f0a67033" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:27:07.166331Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:26:56.710825Z&quot;}" data-execution_count="49">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): missingmar </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1d</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1d</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2d </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2d</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3d </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3d</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1d </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2d </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3d </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1d </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2d </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3d </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>save missingmar, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): missingmar 

      Command: missingmar
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    18.43474    .1438892        18.15238     18.7171
      _sim_2 |      1,000    4.470689    .0070771        4.456801    4.484577
      _sim_3 |      1,000    24.75613    .0472162        24.66347    24.84878
      _sim_4 |      1,000    1.375226    .0021105        1.371085    1.379368
      _sim_5 |      1,000    30.23444     .337308        29.57253    30.89636
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    10.68736    .0160744        10.65581     10.7189
      _sim_7 |      1,000    9.672187    .1436357        9.390325     9.95405
      _sim_8 |      1,000    22.06068    .0473267        21.96781    22.15355
      _sim_9 |      1,000    9.287222    .3390662        8.621858    9.952586
     _sim_10 |      1,000    27.19729     .145471        26.91183    27.48275
-------------+---------------------------------------------------------------
     _sim_11 |      1,000    27.45157    .0474674        27.35842    27.54472
     _sim_12 |      1,000    51.18166    .3384859        50.51744    51.84589

. 
. rename _sim_1 beta1d

. rename _sim_2 se1d

. rename _sim_3 beta2d 

. rename _sim_4 se2d

. rename _sim_5 beta3d 

. rename _sim_6 se3d

. rename _sim_7 ll1d 

. rename _sim_8 ll2d 

. rename _sim_9 ll3d 

. rename _sim_10 ul1d 

. rename _sim_11 ul2d 

. rename _sim_12 ul3d 

. 
. save missingmar, replace
file missingmar.dta saved

. </code></pre>
</div>
</div>
<div id="2a5f499f" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:27:25.902148Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:27:15.290697Z&quot;}" data-execution_count="50">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): missingmean </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1e</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1e</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2e </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2e</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3e </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3e</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1e </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2e </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3e </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1e </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2e </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3e </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>save missingmean, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): missingmean 

      Command: missingmean
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000     33.7555    .2044347        33.35433    34.15667
      _sim_2 |      1,000    6.350052    .0063805        6.337532    6.362573
      _sim_3 |      1,000    25.40088    .0483687        25.30596     25.4958
      _sim_4 |      1,000    2.784375    .0036669        2.777179    2.791571
      _sim_5 |      1,000    56.29951     .492394        55.33327    57.26576
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    15.24848    .0152454        15.21857     15.2784
      _sim_7 |      1,000     21.3094    .2044141        20.90827    21.71053
      _sim_8 |      1,000    19.94351    .0486917        19.84796    20.03905
      _sim_9 |      1,000    26.41249    .4935305        25.44401    27.38096
     _sim_10 |      1,000     46.2016    .2052189        45.79889    46.60431
-------------+---------------------------------------------------------------
     _sim_11 |      1,000    30.85825    .0491069        30.76189    30.95462
     _sim_12 |      1,000    86.18654     .493069        85.21897    87.15411

. 
. rename _sim_1 beta1e

. rename _sim_2 se1e

. rename _sim_3 beta2e 

. rename _sim_4 se2e

. rename _sim_5 beta3e 

. rename _sim_6 se3e

. rename _sim_7 ll1e 

. rename _sim_8 ll2e 

. rename _sim_9 ll3e 

. rename _sim_10 ul1e 

. rename _sim_11 ul2e 

. rename _sim_12 ul3e 

. 
. save missingmean, replace
file missingmean.dta saved

. </code></pre>
</div>
</div>
<div id="16347553" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:28:08.270941Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:27:32.600860Z&quot;}" data-execution_count="51">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): semmlmv </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1f</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1f</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2f </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2f</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3f </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3f</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1f </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2f </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3f </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1f </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2f </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3f </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>save semmlmv, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): semmlmv 

      Command: semmlmv
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    29.92177    .1667615        29.59453    30.24902
      _sim_2 |      1,000    5.142073    .0075898        5.127179    5.156967
      _sim_3 |      1,000    40.02574    .0409192        39.94544    40.10603
      _sim_4 |      1,000     1.28147    .0018418        1.277856    1.285085
      _sim_5 |      1,000    49.54709    .3890354        48.78367    50.31051
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    12.27739    .0176815        12.24269    12.31209
      _sim_7 |      1,000    19.84331    .1651678         19.5192    20.16743
      _sim_8 |      1,000    37.51405    .0386898        37.43813    37.58998
      _sim_9 |      1,000    25.48341    .3866822        24.72461    26.24221
     _sim_10 |      1,000    40.00024    .1696497        39.66733    40.33315
-------------+---------------------------------------------------------------
     _sim_11 |      1,000    42.53742     .043335        42.45238    42.62246
     _sim_12 |      1,000    73.61078    .3944311        72.83677    74.38479

. 
. rename _sim_1 beta1f

. rename _sim_2 se1f

. rename _sim_3 beta2f 

. rename _sim_4 se2f

. rename _sim_5 beta3f 

. rename _sim_6 se3f

. rename _sim_7 ll1f 

. rename _sim_8 ll2f 

. rename _sim_9 ll3f 

. rename _sim_10 ul1f 

. rename _sim_11 ul2f 

. rename _sim_12 ul3f 

. 
. save semmlmv, replace
file semmlmv.dta saved

. </code></pre>
</div>
</div>
<div id="20a556f6" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T10:38:37.005518Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:28:40.290926Z&quot;}" data-execution_count="52">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): minoaux1 </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1g</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1g</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2g </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2g</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3g </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3g</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1g </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2g </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3g </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1g </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2g </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3g </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>save minoaux1, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): minoaux1 

      Command: minoaux1
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    29.54683    .0064244        29.53422    29.55943
      _sim_2 |      1,000    5.572664    .0013789        5.569958     5.57537
      _sim_3 |      1,000    41.44201    .0013083        41.43944    41.44458
      _sim_4 |      1,000    1.301768    .0002573        1.301264    1.302273
      _sim_5 |      1,000    71.25831    .0383802          71.183    71.33363
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    10.61355    .0027411        10.60817    10.61893
      _sim_7 |      1,000    18.62441    .0087418        18.60725    18.64156
      _sim_8 |      1,000    38.89054    .0011773        38.88823    38.89285
      _sim_9 |      1,000    50.45575     .040122        50.37702    50.53448
     _sim_10 |      1,000    40.46925    .0045538        40.46031    40.47819
-------------+---------------------------------------------------------------
     _sim_11 |      1,000    43.99348    .0015955        43.99034    43.99661
     _sim_12 |      1,000    92.06088    .0373368        91.98762    92.13415

. 
. rename _sim_1 beta1g

. rename _sim_2 se1g

. rename _sim_3 beta2g 

. rename _sim_4 se2g

. rename _sim_5 beta3g 

. rename _sim_6 se3g

. rename _sim_7 ll1g 

. rename _sim_8 ll2g 

. rename _sim_9 ll3g 

. rename _sim_10 ul1g 

. rename _sim_11 ul2g 

. rename _sim_12 ul3g 

. 
. save minoaux1, replace
file minoaux1.dta saved

. </code></pre>
</div>
</div>
<div id="32ba28e0" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T11:01:01.298816Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T10:38:37.010642Z&quot;}" data-execution_count="53">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): miaux1 </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1h</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1h</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2h </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2h</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3h </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3h</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1h </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2h </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3h </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1h </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2h </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3h </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>save miaux1, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): miaux1 

      Command: miaux1
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    31.36001    .1790685        31.00862     31.7114
      _sim_2 |      1,000    5.026488    .0139061          4.9992    5.053777
      _sim_3 |      1,000    41.50636    .0164093        41.47416    41.53856
      _sim_4 |      1,000     1.33789    .0059742        1.326167    1.349614
      _sim_5 |      1,000    44.76972    .3280355          44.126    45.41344
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    12.20551    .0160644        12.17399    12.23704
      _sim_7 |      1,000    21.50809    .1519217        21.20997    21.80622
      _sim_8 |      1,000    38.88409    .0207744        38.84333    38.92486
      _sim_9 |      1,000    20.84691    .3139812        20.23077    21.46305
     _sim_10 |      1,000    41.21193     .206244        40.80721    41.61665
-------------+---------------------------------------------------------------
     _sim_11 |      1,000    44.12863    .0195236        44.09031    44.16694
     _sim_12 |      1,000    68.69253    .3444025        68.01669    69.36837

. 
. rename _sim_1 beta1h

. rename _sim_2 se1h

. rename _sim_3 beta2h 

. rename _sim_4 se2h

. rename _sim_5 beta3h 

. rename _sim_6 se3h

. rename _sim_7 ll1h 

. rename _sim_8 ll2h 

. rename _sim_9 ll3h 

. rename _sim_10 ul1h 

. rename _sim_11 ul2h 

. rename _sim_12 ul3h 

. 
. save miaux1, replace
file miaux1.dta saved

. </code></pre>
</div>
</div>
<div id="6edbd7e6" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2025-04-05T16:20:14.497195Z&quot;,&quot;start_time&quot;:&quot;2025-04-05T11:01:01.301350Z&quot;}" data-execution_count="54">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>stata</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upper3, reps(<span class="dv">1000</span>) seed(<span class="dv">1234</span>): miaux100 </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_10 _sim_11 _sim_12</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>rename _sim_1 beta1i</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>rename _sim_2 se1i</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>rename _sim_3 beta2i </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>rename _sim_4 se2i</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>rename _sim_5 beta3i </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>rename _sim_6 se3i</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>rename _sim_7 ll1i </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>rename _sim_8 ll2i </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>rename _sim_9 ll3i </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>rename _sim_10 ul1i </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>rename _sim_11 ul2i </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>rename _sim_12 ul3i </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>save miaux100, replace</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
. 
. simulate beta1 se1 beta2 se2 beta3 se3 lower1 lower2 lower3 upper1 upper2 upp
&gt; er3, reps(1000) seed(1234): miaux100 

      Command: miaux100
       _sim_1: beta1
       _sim_2: se1
       _sim_3: beta2
       _sim_4: se2
       _sim_5: beta3
       _sim_6: se3
       _sim_7: lower1
       _sim_8: lower2
       _sim_9: lower3
      _sim_10: upper1
      _sim_11: upper2
      _sim_12: upper3

Simulations (1,000): .........10.........20.........30.........40.........50...
&gt; ......60.........70.........80.........90.........100.........110.........120
&gt; .........130.........140.........150.........160.........170.........180.....
&gt; ....190.........200.........210.........220.........230.........240.........2
&gt; 50.........260.........270.........280.........290.........300.........310...
&gt; ......320.........330.........340.........350.........360.........370........
&gt; .380.........390.........400.........410.........420.........430.........440.
&gt; ........450.........460.........470.........480.........490.........500......
&gt; ...510.........520.........530.........540.........550.........560.........57
&gt; 0.........580.........590.........600.........610.........620.........630....
&gt; .....640.........650.........660.........670.........680.........690.........
&gt; 700.........710.........720.........730.........740.........750.........760..
&gt; .......770.........780.........790.........800.........810.........820.......
&gt; ..830.........840.........850.........860.........870.........880.........890
&gt; .........900.........910.........920.........930.........940.........950.....
&gt; ....960.........970.........980.........990.........1,000 done

. 
. ci mean _sim_1 _sim_2 _sim_3 _sim_4 _sim_5 _sim_6 _sim_7 _sim_8 _sim_9 _sim_1
&gt; 0 _sim_11 _sim_12

    Variable |        Obs        Mean    Std. err.       [95% conf. interval]
-------------+---------------------------------------------------------------
      _sim_1 |      1,000    24.95661    .0229473        24.91158    25.00165
      _sim_2 |      1,000    4.800662    .0014553        4.797806    4.803518
      _sim_3 |      1,000    38.61344    .0067181        38.60026    38.62662
      _sim_4 |      1,000    1.232736    .0002915        1.232164    1.233308
      _sim_5 |      1,000    38.67783     .044842        38.58984    38.76583
-------------+---------------------------------------------------------------
      _sim_6 |      1,000    11.48743     .003155        11.48124    11.49362
      _sim_7 |      1,000    15.54732    .0205344        15.50702    15.58761
      _sim_8 |      1,000    36.19728    .0062849        36.18494    36.20961
      _sim_9 |      1,000    16.16247     .042354        16.07936    16.24558
     _sim_10 |      1,000    34.36591    .0254513        34.31597    34.41586
-------------+---------------------------------------------------------------
     _sim_11 |      1,000     41.0296    .0071707        41.01553    41.04368
     _sim_12 |      1,000    61.19319    .0480024          61.099    61.28739

. 
. rename _sim_1 beta1i

. rename _sim_2 se1i

. rename _sim_3 beta2i 

. rename _sim_4 se2i

. rename _sim_5 beta3i 

. rename _sim_6 se3i

. rename _sim_7 ll1i 

. rename _sim_8 ll2i 

. rename _sim_9 ll3i 

. rename _sim_10 ul1i 

. rename _sim_11 ul2i 

. rename _sim_12 ul3i 

. 
. save miaux100, replace
file miaux100.dta saved

. </code></pre>
</div>
</div>
</section>
<section id="reference-list" class="level1">
<h1>Reference List</h1>
<p>Allison, P. (2012a) ‘Handling Missing Data by Maximum Likelihood’, SAS Global Forum [Preprint].</p>
<p>Allison, P. (2012b) ‘Why Maximum Likelihood is Better Than Multiple Imputation’, Statistical Horizons, 9 July. Available at: https://statisticalhorizons.com/ml-better-than-mi/ (Accessed: 15 May 2023).</p>
<p>Allison, P. (2015) ‘Maximum Likelihood is Better than Multiple Imputation: Part II’, Statistical Horizons, 5 May. Available at: https://statisticalhorizons.com/ml-is-better-than-mi/ (Accessed: 15 May 2023).</p>
<p>Carpenter, J.R. and Kenward, M. (2012) Multiple imputation and its application. John Wiley &amp; Sons.</p>
<p>Collins, L.M., Schafer, J.L. and Kam, C.-M. (2001) ‘A comparison of inclusive and restrictive strategies in modern missing data procedures.’, Psychological Methods, 6(4), pp.&nbsp;330–351. Available at: https://doi.org/10.1037/1082-989X.6.4.330.</p>
<p>Enders, C.K. (2001) ‘A Primer on Maximum Likelihood Algorithms Available for Use With Missing Data’, Structural Equation Modeling: A Multidisciplinary Journal, 8(1), pp.&nbsp;128–141. Available at: https://doi.org/10.1207/S15328007SEM0801_7.</p>
<p>Enders, C.K. (2010) Applied missing data analysis. New York: Guilford Press (Methodology in the social sciences).</p>
<p>Hardt, J. et al.&nbsp;(2013) ‘Multiple Imputation of Missing Data: A Simulation Study on a Binary Response’, Open Journal of Statistics, 03(05), pp.&nbsp;370–378. Available at: https://doi.org/10.4236/ojs.2013.35043.</p>
<p>Hawkes, D. and Plewis, I. (2006) ‘Modelling non-response in the National Child Development Study’, Journal of the Royal Statistical Society, 169(3), pp.&nbsp;479–491. Available at: https://doi.org/10.1111/j.1467-985X.2006.00401.x.</p>
<p>Hyuk Lee, J. and Huber Jr., J.C. (2021) ‘Evaluation of Multiple Imputation with Large Proportions of Missing Data: How Much Is Too Much?’, Iranian Journal of Public Health [Preprint]. Available at: https://doi.org/10.18502/ijph.v50i7.6626.</p>
<p>Johnson, D.R. and Young, R. (2011) ‘Toward Best Practices in Analyzing Datasets with Missing Data: Comparisons and Recommendations’, Journal of Marriage and Family, 73(5), pp.&nbsp;926–945. Available at: https://doi.org/10.1111/j.1741-3737.2011.00861.x.</p>
<p>Jones, M.P. (1996) ‘Indicator and Stratification Methods for Missing Explanatory Variables in Multiple Linear Regression’, Journal of the American Statistical Association, 91(433).</p>
<p>Kang, H. (2013) ‘The prevention and handling of the missing data’, Korean Journal of Anesthesiology, 64(5), p.&nbsp;402. Available at: https://doi.org/10.4097/kjae.2013.64.5.402.</p>
<p>Little, R.J., Carpenter, J.R. and Lee, K.J. (2022) ‘A Comparison of Three Popular Methods for Handling Missing Data: Complete-Case Analysis, Inverse Probability Weighting, and Multiple Imputation’, Sociological Methods &amp; Research, p.&nbsp;004912412211138. Available at: https://doi.org/10.1177/00491241221113873.</p>
<p>Little, R.J. and Rubin, D.B. (2019) Statistical analysis with missing data. John Wiley &amp; Sons.</p>
<p>Lynch, J. and Von Hippel, P.T. (2013) ‘Efficiency Gains from Using Auxiliary Variables in Imputation’, Cornell University Library [Preprint].</p>
<p>Madley-Dowd, P. et al.&nbsp;(2019) ‘The proportion of missing data should not be used to guide decisions on multiple imputation’, Journal of Clinical Epidemiology, 110, pp.&nbsp;63–73. Available at: https://doi.org/10.1016/j.jclinepi.2019.02.016.</p>
<p>Marsden, P.V. and Wright, J.D. (eds) (2010) Handbook of survey research. Second edition. Bingley: Emerald Group Publ.</p>
<p>Seaman, S.R. et al.&nbsp;(2012) ‘Combining Multiple Imputation and Inverse‐Probability Weighting’, Biometrics, 68(1), pp.&nbsp;129–137. Available at: https://doi.org/10.1111/j.1541-0420.2011.01666.x.</p>
<p>Seaman, S.R. and White, I.R. (2013) ‘Review of inverse probability weighting for dealing with missing data’, Statistical Methods in Medical Research, 22(3), pp.&nbsp;278–295. Available at: https://doi.org/10.1177/0962280210395740.</p>
<p>Silverwood, R. et al.&nbsp;(2021) ‘Handling missing data in the National Child Development Study: User guide (Version 2).’</p>
<p>Von Hippel, P.T. (2009) ‘How to Impute Interactions, Squares, and Other Transformed Variables’, Sociological Methodology, 39(1), pp.&nbsp;265–291. Available at: https://doi.org/10.1111/j.1467-9531.2009.01215.x.</p>
<p>White, I.R., Royston, P. and Wood, A.M. (2011) ‘Multiple imputation using chained equations: Issues and guidance for practice’, Statistics in Medicine, 30(4), pp.&nbsp;377–399. Available at: https://doi.org/10.1002/sim.4067.</p>
<p>Young, R. and Johnson, D.R. (2011) ‘Imputing the Missing Y’s: Implications for Survey Producers and Survey Users’, Proceedings of the AAPOR Conference Abstracts [Preprint].</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>